<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Release Procedures &#8212; Astropy v3.0.dev19489</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0.dev19489',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Workflow for Maintainers" href="workflow/maintainer_workflow.html" />
    <link rel="prev" title="C or Cython Extensions" href="ccython.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="workflow/maintainer_workflow.html" title="Workflow for Maintainers">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="ccython.html" title="C or Cython Extensions">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v3.0.dev19489</a>
	 &#187;
      </li>
      
      <li>Release Procedures</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="release-procedures">
<h1>Release Procedures<a class="headerlink" href="#release-procedures" title="Permalink to this headline">¶</a></h1>
<p>The current release procedure for Astropy involves a combination of an
automated release script and some manual steps.  Future versions will automate
more of the process, if not all.</p>
<div class="section" id="release-procedure">
<span id="id1"></span><h2>Release Procedure<a class="headerlink" href="#release-procedure" title="Permalink to this headline">¶</a></h2>
<p>This is the standard release procedure for releasing Astropy (or affiliated
packages that use the full bugfix/maintenance branch approach.)</p>
<ol class="arabic">
<li><p class="first">(Only for major versions) Make sure to update the &#8220;What&#8217;s new&#8221;
section with the stats on the number of issues, PRs, and contributors.  For
the first two, the <a class="reference external" href="https://github.com/astropy/astropy-tools">astropy-tools repository</a> script <code class="docutils literal"><span class="pre">gh_issuereport.py</span></code>
can provide the numbers since the last major release.  For the final one, you
will likely need to update the Astropy <code class="docutils literal"><span class="pre">.mailmap</span></code> file, as there are often
contributors who are not careful about using the same e-mail address for
every commit.  The easiest way to do this is to run the command
<code class="docutils literal"><span class="pre">git</span> <span class="pre">shortlog</span> <span class="pre">-n</span> <span class="pre">-s</span> <span class="pre">-e</span></code> to see the list of all contributors and their email
addresses.  Look for any mis-named entries or duplicates, and add them to the
<code class="docutils literal"><span class="pre">.mailmap</span></code> file (matched to the appropriate canonical name/email address.)
Once you have finished this, you can could the number of lines in
<code class="docutils literal"><span class="pre">git</span> <span class="pre">shortlog</span> <span class="pre">-s</span></code> to get the final contributor count.</p>
</li>
<li><p class="first">Also be sure to update the <code class="docutils literal"><span class="pre">docs/credits.rst</span></code> file to include any new
contributors.  This can come from the above step, or the <code class="docutils literal"><span class="pre">author_lists.py</span></code>
script in the <a class="reference external" href="https://github.com/astropy/astropy-tools">astropy-tools repository</a> mostly automates this.  (This
step is only required on major releases, but can be done for bugfix releases
as time allows.)</p>
</li>
<li><p class="first">(Optional) You may want to set up a clean environment to build the release.
For more on setting up virtual environments, see <a class="reference internal" href="workflow/virtual_pythons.html#virtual-envs"><span class="std std-ref">Python virtual environments</span></a>, but
for the sake of example we will assume you&#8217;re using <a class="reference external" href="http://conda.pydata.org/docs/">Anaconda</a>. This is not
necessary if you know your normal python environment has what you need, but
you might want to do something like this for safety&#8217;s sake:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ conda create -n astropy_release_build_v&lt;version&gt; astropy
$ source activate astropy_release_build_v&lt;version&gt;
$ conda uninstall astropy  # still keeps the dependencies
$ pip install -r pip-requirements-dev  # any that might be left over
</pre></div>
</div>
</li>
<li><p class="first">Before doing a release of Astropy, you may need to do a release of
astropy-helpers.  This is not always necessary, as there are not always any
significant changes in the helpers.  See <a class="reference internal" href="#helpers-release-info"><span class="std std-ref">Coordinating Astropy and astropy-helpers Releases</span></a> for more
on this.</p>
</li>
<li><p class="first">Make sure that the continuous integration services (e.g., Travis) are passing
for the <a class="reference external" href="https://github.com/astropy/astropy">astropy core repository</a> branch you&#8217;re going to release.  You may
also want to locally run the tests (with remote data on to ensure all the
tests actually run), and make sure the description in <code class="docutils literal"><span class="pre">setup.py</span></code> is ReST
compliant:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python setup.py test --remote-data=any
$ python setup.py check --restructuredtext
</pre></div>
</div>
</li>
<li><p class="first">Ensure you have a GPG key pair available for when git needs to sign the
tag you create for the release.  See <a class="reference internal" href="#key-signing-info"><span class="std std-ref">Creating a GPG Signing Key and a Signed Tag</span></a> for more on
this.</p>
</li>
<li><p class="first">Obtain a <em>clean</em> version of the <a class="reference external" href="https://github.com/astropy/astropy">astropy core repository</a>.  That is, one
where you don&#8217;t have any intermediate build files.  Either use a fresh
<code class="docutils literal"><span class="pre">git</span> <span class="pre">clone</span></code> or do <code class="docutils literal"><span class="pre">git</span> <span class="pre">clean</span> <span class="pre">-dfx</span></code>. If you choose to clean the working tree,
don&#8217;t forget to clean the <code class="docutils literal"><span class="pre">astropy_helpers</span></code> submodule, too.</p>
</li>
<li><p class="first">Be sure you&#8217;re on the branch appropriate for the version you&#8217;re about to
release.  For example, if releasing version 1.2.2 make sure to:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git checkout v1.2.x
</pre></div>
</div>
</li>
<li><p class="first">Edit the <code class="docutils literal"><span class="pre">CHANGES.rst</span></code> file by changing the date for the version you are
about to release from &#8220;unreleased&#8221; to today&#8217;s date.  Also be sure to remove
any sections of the changelog for that version that have no entries.  Then
add and commit those changes with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;use your favorite editor on CHANGES.rst&gt;
$ git add CHANGES.rst
$ git commit -m &quot;Finalizing changelog for v&lt;version&gt;&quot;
</pre></div>
</div>
</li>
<li><p class="first">Edit the <code class="docutils literal"><span class="pre">setup.py</span></code> file by removing the <code class="docutils literal"><span class="pre">&quot;.dev&quot;</span></code> at the end of the
<code class="docutils literal"><span class="pre">VERSION</span></code> string, then add and commit that change as the final step prior
to release:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;use your favorite editor on setup.py&gt;
$ git add setup.py
$ git commit -m &quot;Preparing release v&lt;version&gt;&quot;
</pre></div>
</div>
</li>
<li><p class="first">Tag the commit with <code class="docutils literal"><span class="pre">v&lt;version&gt;</span></code>, being certain to sign the tag with the
<code class="docutils literal"><span class="pre">-s</span></code> option:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git tag -s v&lt;version&gt; -m &quot;Tagging v&lt;version&gt;&quot;
</pre></div>
</div>
</li>
<li><p class="first">Edit the <code class="docutils literal"><span class="pre">VERSION</span></code> in <code class="docutils literal"><span class="pre">setup.py</span></code> to be the next version number, but with
a <code class="docutils literal"><span class="pre">.dev</span></code> suffix at the end (E.g., <code class="docutils literal"><span class="pre">1.2.3.dev</span></code>).  Then add and commit:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;use your favorite editor on setup.py&gt;
$ git add setup.py
$ git commit -m &quot;Back to development: v&lt;next_version&gt;.dev&quot;
</pre></div>
</div>
</li>
<li><p class="first">Also update the <code class="docutils literal"><span class="pre">CHANGES.rst</span></code> file with a new section for the next version.
You will likely want to use the <code class="docutils literal"><span class="pre">add_to_changelog.py</span></code> script in the
<a class="reference external" href="https://github.com/astropy/astropy-tools">astropy-tools repository</a> for this.  Then add and commit:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;use your favorite editor on CHANGES.rst&gt;
$ git add CHANGES.rst
$ git commit -m &quot;Add v&lt;next_version&gt; to the changelog&quot;
</pre></div>
</div>
</li>
<li><p class="first">Now go back and check out the tag of the released version with
<code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">v&lt;version&gt;</span></code>.  For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git checkout v1.2.2
</pre></div>
</div>
<p>Don&#8217;t forget to remove any non-committed files both from the main working tree
and <code class="docutils literal"><span class="pre">astropy_helpers</span></code> submodules with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git clean -dfx
$ cd astropy_helpers; git clean -dfx; cd ..
</pre></div>
</div>
</li>
<li><p class="first">Make sure the source distribution doesn&#8217;t inherit limited permissions
following your default umask:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ umask 0022
$ chmod -R a+Xr .
</pre></div>
</div>
</li>
<li><p class="first">Create the source distribution by doing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python setup.py build sdist
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the future, the <code class="docutils literal"><span class="pre">build</span></code> command may run automatically as a
prerequisite for <code class="docutils literal"><span class="pre">sdist</span></code>.  But for now, make sure to run it
whenever running <code class="docutils literal"><span class="pre">sdist</span></code> to ensure that all Cython sources and
other generated files are built.</p>
</div>
</li>
<li><p class="first">Run the tests in an environment that mocks up a &#8220;typical user&#8221; scenario.
This is not strictly necessary because you ran the tests above, but
it can sometimes be useful to catch subtle bugs that might come from you
using a customized developer environment.  For more on setting up virtual
environments, see <a class="reference internal" href="workflow/virtual_pythons.html#virtual-envs"><span class="std std-ref">Python virtual environments</span></a>, but for the sake of example we will
assume you&#8217;re using <a class="reference external" href="http://conda.pydata.org/docs/">Anaconda</a>. Do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ conda create -n astropy_release_test_v&lt;version&gt; numpy
$ source activate astropy_release_test_v&lt;version&gt;
$ pip install dist/astropy-&lt;version&gt;.tar.gz
$ python -c &#39;import astropy; astropy.test(remote_data=True)&#39;
$ source deactivate
</pre></div>
</div>
</li>
<li><p class="first">Build and test the Astropy wheels.  See the <a class="reference external" href="https://github.com/MacPython/astropy-wheels">wheel builder README</a> for instructions.  In
summary, clone the wheel-building repo, edit the <code class="docutils literal"><span class="pre">.travis.yml</span></code> and
<code class="docutils literal"><span class="pre">appveyor.yml</span></code> text files with the branch or commit for the release,
commit and then push back up to github.  This will trigger a wheel build
and test on OSX, Linux and Windows. Check the build has passed on on the
Travis-CI interface at <a class="reference external" href="https://travis-ci.org/MacPython/astropy-wheels">https://travis-ci.org/MacPython/astropy-wheels</a>.
You&#8217;ll need commit privileges to the <code class="docutils literal"><span class="pre">astropy-wheels</span></code> repo; ask Tom Kooij
or on the mailing list if you do not have them.</p>
</li>
<li><p class="first">If the tests do <em>not</em> pass, you&#8217;ll have to fix whatever the problem is.
First you&#8217;ll need to back out the release procedure by dropping the commits
you made for release and removing the tag you created:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git reset --hard HEAD^^^^ # you could also use the SHA hash of the commit before your first changelog edit
$ git tag -d v&lt;version&gt;
</pre></div>
</div>
</li>
<li><p class="first">Once the tests are all passing, it&#8217;s time to actually proceed with the
release! This has two steps:</p>
<ul class="simple">
<li>build and upload the Astropy wheels;</li>
<li>make and upload the Astropy source release.</li>
</ul>
</li>
<li><p class="first">For the wheel build / upload, follow the <a class="reference external" href="https://github.com/MacPython/astropy-wheels">wheel builder README</a>
instructions again.  Edit the <code class="docutils literal"><span class="pre">.travis.yml</span></code> and <code class="docutils literal"><span class="pre">appveyor.yml</span></code> files
to give the release tag to build.  Check the build has passed on on the
Travis-CI interface at <a class="reference external" href="https://travis-ci.org/MacPython/astropy-wheels">https://travis-ci.org/MacPython/astropy-wheels</a>.  Now
follow the instructions in the page above to download the built wheels to a
local machine and upload to PyPI.</p>
</li>
<li><p class="first">Now the wheels are built and uploaded, you can upload the source release.
For safety&#8217;s sake, you may want to clean the repo yet again to make sure
you didn&#8217;t leave anything from the previous step:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git clean -dfx
$ cd astropy_helpers; git clean -dfx; cd ..
</pre></div>
</div>
</li>
<li><p class="first">Upload the source distribution to PyPI; this is preceded by re-running
the sdist command, which makes sure the source code is packaged up and ready
to be uploaded:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python setup.py build sdist upload --sign
</pre></div>
</div>
</li>
<li><p class="first">Go to <a class="reference external" href="https://pypi.python.org/pypi?:action=pkg_edit&amp;name=astropy">https://pypi.python.org/pypi?:action=pkg_edit&amp;name=astropy</a>
and ensure that only the most recent releases in each actively maintained
release line are <em>not</em> marked hidden.  For example, if v1.2.2 was
just released, v1.2.1 should be hidden.  This is so that users only find
the latest bugfix releases.</p>
<p>Do not enabled &#8220;Auto-hide old releases&#8221; as that may hide bugfix releases
from older release lines that we may still want to make available.</p>
</li>
<li><p class="first">Push up these changes and the tag to the <a class="reference external" href="https://github.com/astropy/astropy">astropy core repository</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git push upstream v&lt;version branch&gt;.x
$ git push upstream v&lt;version branch&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may need to replace <code class="docutils literal"><span class="pre">upstream</span></code> here with <code class="docutils literal"><span class="pre">astropy</span></code> or
whatever remote name you use for the <a class="reference external" href="https://github.com/astropy/astropy">astropy core repository</a>.
Also, it might be tempting to use the <code class="docutils literal"><span class="pre">--tags</span></code> argument to <code class="docutils literal"><span class="pre">git</span> <span class="pre">push</span></code>,
but this should <em>not</em> be done, as it might push up some unintended tags.</p>
</div>
</li>
<li><p class="first">If this is a release of the current release (i.e., not an LTS supported along
side a more recent version), update the &#8220;stable&#8221; branch to point to the new
release:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git checkout stable
$ git reset --hard v&lt;version&gt;
$ git push upstream stable --force
</pre></div>
</div>
</li>
<li><p class="first">Update Readthedocs so that it builds docs for the version you just released.
You&#8217;ll find this in the &#8220;admin&#8221; tab, with checkboxes next to each github tag.
Also verify that the <code class="docutils literal"><span class="pre">stable</span></code> Readthedocs version builds correctly for
the new version (it should trigger automatically once you&#8217;ve done the
previous step).</p>
</li>
<li><p class="first">When releasing a patch release, also set the previous RTD version in the
release history to &#8220;protected&#8221;.  For example when releasing v1.1.2, set
v1.1.1 to &#8220;protected&#8221;.  This prevents the previous releases from
cluttering the list of versions that users see in the version dropdown
(the previous versions are still accessible by their URL though).</p>
</li>
<li><p class="first">Update the Astropy web site by editing the <code class="docutils literal"><span class="pre">index.html</span></code> page at
<a class="reference external" href="https://github.com/astropy/astropy.github.com">https://github.com/astropy/astropy.github.com</a> by changing the &#8220;current
version&#8221; link and/or updating the list of older versions if this is an LTS
bugfix or a new major version.  You may also need to update the contributor
list on the web site if you updated the <code class="docutils literal"><span class="pre">docs/credits.rst</span></code> at the outset.</p>
</li>
<li><p class="first">In the astropy <em>master</em> branch (not just the maintenance branch), be sure to
update the <code class="docutils literal"><span class="pre">CHANGES.rst</span></code> to reflect the date of the release you just
performed and to include the new section of the changelog.  Often the easiest
way to do this is to use <code class="docutils literal"><span class="pre">git</span> <span class="pre">cherry-pick</span></code> the changelog commit just before
the release commit from above. If you aren&#8217;t sure how to do this, you might
be better off just copying-and-pasting the relevant parts of the maintenance
branch&#8217;s <code class="docutils literal"><span class="pre">CHANGES.rst</span></code> into master.</p>
</li>
<li><p class="first">If there are any issues in the Github issue tracker that are labeled
<code class="docutils literal"><span class="pre">affects-dev</span></code> but are issues that apply to this release, update them to
<code class="docutils literal"><span class="pre">affects-release</span></code>.  Similarly, if any issues remain open for this release,
re-assign them to the next relevant milestone.</p>
</li>
<li><p class="first">Create a github milestone for the next bugfix version, move any remaining
issues from the version you just released, and close the milestone. When
releasing a major release, close the last milestone on the previous
maintenance branch, too.</p>
</li>
<li><p class="first">Notify the Conda Distribution Maintainer and the Continuous Integration
maintainer about the new release.  Typically, you should wait to make sure
<code class="docutils literal"><span class="pre">conda-forge</span></code> and possible <code class="docutils literal"><span class="pre">conda</span></code> works before sending out the public
announcement (so that users that want to try out the new version can do
so on conda).</p>
</li>
<li><p class="first">Update the <code class="docutils literal"><span class="pre">LATEST_ASTROPY_STABLE</span></code> or <code class="docutils literal"><span class="pre">ASTROPY_LTS_VERSION</span></code> variables
in the <code class="docutils literal"><span class="pre">ci-helpers</span></code> repository once the <code class="docutils literal"><span class="pre">conda</span></code> packages became
available.</p>
</li>
</ol>
<div class="section" id="modifications-for-a-beta-release-candidate-release">
<h3>Modifications for a beta/release candidate release<a class="headerlink" href="#modifications-for-a-beta-release-candidate-release" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>For major releases we do beta and/or release candidates to have a chance to
catch significant bugs before the true release. If the release you are
performing is this kind of pre-release, some of the above steps need to be
modified.</p>
<p>The primary modifications to the release procedure are:</p>
<ul class="simple">
<li>When entering the new version number, instead of just removing the
<code class="docutils literal"><span class="pre">.dev</span></code>, enter &#8220;1.2b1&#8221; or &#8220;1.2rc1&#8221;.  It is critical that you follow this
numbering scheme (<code class="docutils literal"><span class="pre">x.yb#</span></code> or <code class="docutils literal"><span class="pre">x.y.zrc#</span></code>), as it will ensure the release
is ordered &#8220;before&#8221; the main release by various automated tools, and also
tells PyPI that this is a &#8220;pre-release&#8221;.</li>
<li>Do <em>not</em> do the step of adding <code class="docutils literal"><span class="pre">.dev</span></code> in the &#8220;back to development&#8221; stage.
If an RC goes well, there&#8217;s no need for a &#8220;dev&#8221; stage, as the same version
will be released with only minor doc updates, and strings like &#8220;x.yrcz.dev&#8221;
confuse some version number parsing tools.</li>
<li>Do not do step #22 or later, as those are tasks for an actual release.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="performing-a-feature-freeze-branching-new-major-versions">
<h2>Performing a Feature Freeze/Branching new Major Versions<a class="headerlink" href="#performing-a-feature-freeze-branching-new-major-versions" title="Permalink to this headline">¶</a></h2>
<p>As outlined in
<a class="reference external" href="https://github.com/astropy/astropy-APEs/blob/master/APE2.rst">APE2</a>, astropy
releases occur at regular intervals, but feature freezes occur well before the
actual release.  Feature freezes are also the time when the master branch&#8217;s
development separates from the new major version&#8217;s maintenance branch.  This
allows new development for the next major version to continue while the
soon-to-be-released version can focus on bug fixes and documentation updates.</p>
<p>The procedure for this is straightforward:</p>
<ol class="arabic">
<li><p class="first">Make sure you&#8217;re on master, and updated to the latest version from github:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git checkout master
$ git fetch upstream
$ git reset --hard upstream/master
</pre></div>
</div>
</li>
<li><p class="first">Create a new branch from master at the point you want the feature freeze to
occur:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git branch v&lt;version&gt;.x
</pre></div>
</div>
</li>
<li><p class="first">Update the <code class="docutils literal"><span class="pre">VERSION</span></code> in <code class="docutils literal"><span class="pre">setup.py</span></code> to reflect the new major version. For
example, if you are about to issue a feature freeze for version <code class="docutils literal"><span class="pre">1.2</span></code>, you
will want to set the new version to <code class="docutils literal"><span class="pre">'1.3.dev'</span></code>. Then add and commit that:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;use your favorite editor on setup.py&gt;
$ git add setup.py
$ git commit -m &quot;Next major version: &lt;next_version&gt;&quot;
</pre></div>
</div>
</li>
<li><p class="first">Update the <code class="docutils literal"><span class="pre">CHANGES.rst</span></code> file with a new section at the very top for the
next major version.  You will likely want to use the <code class="docutils literal"><span class="pre">add_to_changelog.py</span></code>
script in the <a class="reference external" href="https://github.com/astropy/astropy-tools">astropy-tools repository</a> for this. Then add and commit those
changes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;use your favorite editor on CHANGES.rst&gt;
$ git add CHANGES.rst
$ git commit -m &quot;Add &lt;next_version&gt; to changelog&quot;
</pre></div>
</div>
</li>
<li><p class="first">Also update the &#8220;what&#8217;s new&#8221; section of the docs to include a section for the
next major version.  E.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cp docs/whatsnew/&lt;current_version&gt;.rst docs/whatsnew/&lt;next_version&gt;.rst
</pre></div>
</div>
<p>You&#8217;ll then need to edit <code class="docutils literal"><span class="pre">docs/whatsnew/&lt;next_version&gt;.rst</span></code>, removing all
the content but leaving the basic structure.  You may also need  to
replace the &#8220;by the numbers&#8221; numbers with &#8220;xxx&#8221; as a reminder to update them
before the next release. Then add the new version to the top of
<code class="docutils literal"><span class="pre">docs/whatsnew/index.rst</span></code>, update the reference in <code class="docutils literal"><span class="pre">docs/index.rst</span></code> to
point to the that version, and commit these changes</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git add docs/whatsnew/&lt;next_version&gt;.rst
$ git add docs/whatsnew/index.rst
$ git add docs/index.rst
$ git commit -m &quot;Added &lt;next_version&gt; whats new section&quot;
</pre></div>
</div>
</li>
<li><p class="first">Push all of these changes up to github:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git push upstream v&lt;version&gt;.x:v&lt;version&gt;.x
$ git push upstream master:master
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may need to replace <code class="docutils literal"><span class="pre">upstream</span></code> here with <code class="docutils literal"><span class="pre">astropy</span></code> or
whatever remote name you use for the <a class="reference external" href="https://github.com/astropy/astropy">astropy core repository</a>.</p>
</div>
</li>
<li><p class="first">On the github issue tracker, add a new milestone for the next major version.</p>
</li>
<li><p class="first">Repeat the above steps for the astropy-helpers, using the same version series.</p>
</li>
</ol>
</div>
<div class="section" id="maintaining-bug-fix-releases">
<h2>Maintaining Bug Fix Releases<a class="headerlink" href="#maintaining-bug-fix-releases" title="Permalink to this headline">¶</a></h2>
<p>Astropy releases, as recommended for most Python projects, follows a
&lt;major&gt;.&lt;minor&gt;.&lt;micro&gt; version scheme, where the &#8220;micro&#8221; version is also
known as a &#8220;bug fix&#8221; release.  Bug fix releases should not change any user-
visible interfaces.  They should only fix bugs on the previous major/minor
release and may also refactor internal APIs or include omissions from previous
releases&#8211;that is, features that were documented to exist but were accidentally
left out of the previous release. They may also include changes to docstrings
that enhance clarity but do not describe new features (e.g., more examples,
typo fixes, etc).</p>
<p>Bug fix releases are typically managed by maintaining one or more bug fix
branches separate from the master branch (the release procedure below discusses
creating these branches).  Typically, whenever an issue is fixed on the Astropy
master branch a decision must be made whether this is a fix that should be
included in the Astropy bug fix release.  Usually the answer to this question
is &#8220;yes&#8221;, though there are some issues that may not apply to the bug fix
branch.  For example, it is not necessary to backport a fix to a new feature
that did not exist when the bug fix branch was first created.  New features
are never merged into the bug fix branch&#8211;only bug fixes; hence the name.</p>
<p>In rare cases a bug fix may be made directly into the bug fix branch without
going into the master branch first.  This may occur if a fix is made to a
feature that has been removed or rewritten in the development version and no
longer has the issue being fixed.  However, depending on how critical the bug
is it may be worth including in a bug fix release, as some users can be slow to
upgrade to new major/micro versions due to API changes.</p>
<p>Issues are assigned to an Astropy release by way of the Milestone feature in
the GitHub issue tracker.  At any given time there are at least two versions
under development: The next major/minor version, and the next bug fix release.
For example, at the time of writing there are two release milestones open:
v1.2.2 and v0.3.0.  In this case, v1.2.2 is the next bug fix release and all
issues that should include fixes in that release should be assigned that
milestone.  Any issues that implement new features would go into the v0.3.0
milestone&#8211;this is any work that goes in the master branch that should not
be backported.  For a more detailed set of guidelines on using milestones, see
<a class="reference internal" href="workflow/maintainer_workflow.html#milestones-and-labels"><span class="std std-ref">Using Milestones and Labels</span></a>.</p>
<div class="section" id="backporting-fixes-from-master">
<h3>Backporting fixes from master<a class="headerlink" href="#backporting-fixes-from-master" title="Permalink to this headline">¶</a></h3>
<p>Most fixes are backported using the <code class="docutils literal"><span class="pre">git</span> <span class="pre">cherry-pick</span></code> command, which applies
the diff from a single commit like a patch.  For the sake of example, say the
current bug fix branch is &#8216;v1.2.x&#8217;, and that a bug was fixed in master in a
commit <code class="docutils literal"><span class="pre">abcd1234</span></code>.  In order to backport the fix, simply checkout the v1.2.x
branch (it&#8217;s also good to make sure it&#8217;s in sync with the
<a class="reference external" href="https://github.com/astropy/astropy">astropy core repository</a>) and cherry-pick the appropriate commit:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git checkout v1.2.x
$ git pull upstream v1.2.x
$ git cherry-pick abcd1234
</pre></div>
</div>
<p>Sometimes a cherry-pick does not apply cleanly, since the bug fix branch
represents a different line of development.  This can be resolved like any
other merge conflict:  Edit the conflicted files by hand, and then run
<code class="docutils literal"><span class="pre">git</span> <span class="pre">commit</span></code> and accept the default commit message.  If the fix being
cherry-picked has an associated changelog entry in a separate commit make
sure to backport that as well.</p>
<p>What if the issue required more than one commit to fix?  There are a few
possibilities for this.  The easiest is if the fix came in the form of a
pull request that was merged into the master branch.  Whenever GitHub merges
a pull request it generates a merge commit in the master branch.  This merge
commit represents the <em>full</em> difference of all the commits in the pull request
combined.  What this means is that it is only necessary to cherry-pick the
merge commit (this requires adding the <code class="docutils literal"><span class="pre">-m</span> <span class="pre">1</span></code> option to the cherry-pick
command).  For example, if <code class="docutils literal"><span class="pre">5678abcd</span></code> is a merge commit:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git checkout v1.2.x
$ git pull upstream v1.2.x
$ git cherry-pick -m 1 5678abcd
</pre></div>
</div>
<p>In fact, because Astropy emphasizes a pull request-based workflow, this is the
<em>most</em> common scenario for backporting bug fixes, and the one requiring the
least thought.  However, if you&#8217;re not dealing with backporting a fix that was
not brought in as a pull request, read on.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="workflow/additional_git_topics.html#merge-commits-and-cherry-picks"><span class="std std-ref">Merge commits and cherry picks</span></a> for further explanation of the
cherry-pick command and how it works with merge commits.</p>
</div>
<p>If not cherry-picking a merge commit there are still other options for dealing
with multiple commits.  The simplest, though potentially tedious, is to simply
run the cherry-pick command once for each commit in the correct order.
However, as of Git 1.7.2 it is possible to merge a range of commits like so:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git cherry-pick 1234abcd..56789def
</pre></div>
</div>
<p>This works fine so long as the commits you want to pick are actually congruous
with each other.  In most cases this will be the case, though some bug fixes
will involve followup commits that need to back backported as well.  Most bug
fixes will have an issues associated with it in the issue tracker, so make sure
to reference all commits related to that issue in the commit message.  That way
it&#8217;s harder for commits that need to be backported from getting lost.</p>
</div>
<div class="section" id="making-fixes-directly-to-the-bug-fix-branch">
<h3>Making fixes directly to the bug fix branch<a class="headerlink" href="#making-fixes-directly-to-the-bug-fix-branch" title="Permalink to this headline">¶</a></h3>
<p>As mentioned earlier in this section, in some cases a fix only applies to a bug
fix release, and is not applicable in the mainline development.  In this case
there are two choices:</p>
<ol class="arabic simple">
<li>An Astropy developer with commit access to the <a class="reference external" href="https://github.com/astropy/astropy">astropy core repository</a> may
check out the bug fix branch and commit and push your fix directly.</li>
<li><strong>Preferable</strong>: You may also make a pull request through GitHub against the
bug fix branch rather than against master.  Normally when making a pull
request from a branch on your fork to the <a class="reference external" href="https://github.com/astropy/astropy">astropy core repository</a>, GitHub
compares your branch to Astropy&#8217;s master.  If you look on the left-hand
side of the pull request page, under &#8220;base repo: astropy/astropy&#8221; there is
a drop-down list labeled &#8220;base branch: master&#8221;.  You can click on this
drop-down and instead select the bug fix branch (&#8220;v1.2.x&#8221; for example). Then
GitHub will instead compare your fix against that branch, and merge into
that branch when the PR is accepted.</li>
</ol>
</div>
<div class="section" id="preparing-the-bug-fix-branch-for-release">
<h3>Preparing the bug fix branch for release<a class="headerlink" href="#preparing-the-bug-fix-branch-for-release" title="Permalink to this headline">¶</a></h3>
<p>There are two primary steps that need to be taken before creating a bug fix
release. The rest of the procedure is the same as any other release as
described in <a class="reference internal" href="#release-procedure"><span class="std std-ref">Release Procedure</span></a> (although be sure to provide the
right version number).</p>
<ol class="arabic simple">
<li>Any existing fixes to the issues assigned to a release milestone (and older
LTS releases, if there are any), must be included in the maintenance branch
before release.</li>
<li>The Astropy changelog must be updated to list all issues&#8211;especially
user-visible issues&#8211;fixed for the current release.  The changelog should
be updated in the master branch, and then merged into the bug fix branch.
Most issues <em>should</em> already have changelog entries for them. But
occasionally these are forgotten, so if doesn&#8217;t exist yet please add one in
the process of backporting.  See <a class="reference internal" href="workflow/maintainer_workflow.html#changelog-format"><span class="std std-ref">Updating and Maintaining the Changelog</span></a> for more details.</li>
</ol>
<p>To aid this process, there are a series of related scripts in the
<a class="reference external" href="https://github.com/astropy/astropy-tools">astropy-tools repository</a>, in the <code class="docutils literal"><span class="pre">pr_consistency</span></code> directory.  These scripts
essentially check that the above two conditions are met. Detailed documentation
for these scripts is given in their repository, but here we summarize the basic
workflow.  Run the scripts in order (they are numbered 1.&lt;something&gt;.py,
2.&lt;something&gt;.py, etc.), entering your github login credentials as needed (if
you are going to run them multiple times, using a <code class="docutils literal"><span class="pre">~/.netrc</span></code> file is
recommended - see <a class="reference external" href="http://stackoverflow.com/questions/5343068/is-there-a-way-to-skip-password-typing-when-using-https-on-github/18362082">this Stack Overflow post</a>
for more on how to do that, or
<a class="reference external" href="https://help.github.com/articles/caching-your-github-password-in-git">a similar github help page</a>).
The script to actually check consistency should be run like:</p>
<blockquote>
<div>$ python 4.check_consistency.py &gt; consistency.html</div></blockquote>
<p>Which will generate a simple web page that shows all of the areas where either
a pull request was merged into master but is <em>not</em> in the relevant release that
it has been milestoned for, as well as any changelog irregularities (i.e., PRs
that are in the wrong section for what the github milestone indicates).  You&#8217;ll
want to correct those irregularities <em>first</em> before starting the backport
process (re-running the scripts in order as needed).</p>
<p>The end of the <code class="docutils literal"><span class="pre">consistency.html</span></code> page will then show a series of
<code class="docutils literal"><span class="pre">git</span> <span class="pre">cherry-pick</span></code> commands to update the maintenance branch with the PRs that
are needed to make the milestones and branches consistent.  Make sure you&#8217;re in
the correct maintenance branch with e.g.,</p>
<blockquote>
<div>$ git checkout v1.3.x
$ git pull upstream v1.3.x  # Or possibly a rebase if conflicts exist</div></blockquote>
<p>if you are doing bugfixes for the 1.3.x series. Go through the commands one at a
time, following the cherry-picking procedure described above. If for some reason
you determine the github milestone was in error and the backporting is
impossible, re-label the issue on github and move on.  Also, whenever you
backport a PR, it&#8217;s useful to leave a comment in the issue along the lines of
&#8220;backported this to v1.3.x as &lt;SHA&gt;&#8221; so that it&#8217;s clear that the backport
happened to others who might later look.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Automated scripts are never perfect, and can either miss issues that need to
be backported, or in some cases can report false positives.</p>
<p>It&#8217;s always a good idea before finalizing a bug fix release to look on
GitHub through the list of closed issues in the release milestone and check
that each one has a fix in the bug fix branch.  Usually a quick way to do
this is for each issue to run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git log --oneline &lt;bugfix-branch&gt; | grep #&lt;issue&gt;
</pre></div>
</div>
<p class="last">Most fixes will mention their related issue in the commit message, so this
tends to be pretty reliable.  Some issues won&#8217;t show up in the commit log,
however, as their fix is in a separate pull request.  Usually GitHub makes
this clear by cross-referencing the issue with its PR.  A future version
of the <code class="docutils literal"><span class="pre">suggest_backports.py</span></code> script will perform this check
automatically.</p>
</div>
<p>Finally, not all issues assigned to a release milestone need to be fixed before
making that release.  Usually, in the interest of getting a release with
existing fixes out within some schedule, it&#8217;s best to triage issues that won&#8217;t
be fixed soon to a new release milestone.  If the upcoming bug fix release is
&#8216;v1.2.2&#8217;, then go ahead and create a &#8216;v1.2.3&#8217; milestone and reassign to it any
issues that you don&#8217;t expect to be fixed in time for &#8216;v1.2.2&#8217;.</p>
</div>
</div>
<div class="section" id="coordinating-astropy-and-astropy-helpers-releases">
<span id="helpers-release-info"></span><h2>Coordinating Astropy and astropy-helpers Releases<a class="headerlink" href="#coordinating-astropy-and-astropy-helpers-releases" title="Permalink to this headline">¶</a></h2>
<p>A bit more initial effort is required for an Astropy release that has a
corresponding astropy-helpers release.  The main reason for this more complex
procedure is to allow the Astropy core to be tested against the new helpers
before anything is released.  Hence the following procedure should be added
to the beginning of the above procedure when this is required. This procedure
applies both for regular release <em>and</em> release candidates are the same
(except that version numbers have <code class="docutils literal"><span class="pre">rc#</span></code> at the end).</p>
<ol class="arabic">
<li><p class="first">In the <a class="reference external" href="https://github.com/astropy/astropy-helpers">astropy-helpers repository</a>, create a new (temporary) branch
&#8220;tmp-release-v&lt;version&gt;&#8221;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd /wherever/you/put/astropy/astropy_helpers
$ git branch tmp-release-v&lt;version&gt; &lt;maintenance branch name&gt;
</pre></div>
</div>
</li>
<li><p class="first">In that branch, create release commits by updating the changelog and then the
version info and as described in the release instructions above.</p>
</li>
<li><p class="first">Push the branch you just created to the <a class="reference external" href="https://github.com/astropy/astropy-helpers">astropy-helpers repository</a> on
github:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git push upstream tmp-release-v&lt;version&gt;
</pre></div>
</div>
</li>
<li><p class="first">In astropy master (or the relevant maintenance branch for the release you
are doing), issue a PR updating the helpers to the commit described in the
last step (i.e., the commit at the head of the &#8220;tmp-release-v&lt;version&gt;&#8221;
branch you just created).  The easiest way to do this is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cd /wherever/you/put/astropy
$ cd astropy_helpers
$ git fetch upstream  # you probably did this already in the previous step
$ git checkout upstream/tmp-release-v&lt;version&gt;
$ cd ..
$ git add astropy_helpers
$ git commit -m &quot;updated helpers to v&lt;version&gt;&quot;
</pre></div>
</div>
</li>
<li><p class="first">Wait for the continuous integration services (e.g., Travis) to run on the PR
to ensure the release commit of the helpers works with the to-be-released
version of Astropy.</p>
</li>
<li><p class="first">If the PR&#8217;s tests fail, fix whatever the problem is, and then re-do this
procedure. You&#8217;ll need to either delete the previous &#8220;tmp-release-v&lt;version&gt;&#8221;
branch on the github <a class="reference external" href="https://github.com/astropy/astropy-helpers">astropy-helpers repository</a> or use <code class="docutils literal"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">-f</span></code>
when you push up the replacement temporary release branch. You can re-use the
PR into the <a class="reference external" href="https://github.com/astropy/astropy">astropy core repository</a> (created in the step just before this
one) by updating the <code class="docutils literal"><span class="pre">astropy_helpers</span></code> submodule to point to the new
&#8220;tmp-release-v&lt;version&gt;&#8221; from  <em>after</em> the fix - that way you don&#8217;t need to
make another PR for the fixed version.</p>
</li>
<li><p class="first">Once the tests all succeed, finish the release of the helpers by doing this
in the helpers repo:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git checkout &lt;maintenance branch name&gt;
$ git merge --no-ff tmp-release-v&lt;version&gt;
$ git tag -s &quot;v&lt;version&gt;&quot; -m &quot;Tagging v&lt;version&gt;&quot;
$ python setup.py build sdist register upload
$ git push upstream --tags &lt;maintenance branch name&gt;
</pre></div>
</div>
</li>
<li><p class="first">Update the changelog and version number in <em>master</em> of the
<a class="reference external" href="https://github.com/astropy/astropy-helpers">astropy-helpers repository</a> to reflect the release you just did (detailed
instructions are above).</p>
</li>
<li><p class="first">Delete the temporary branch from github:</p>
<blockquote>
<div><p>$ git push upstream :tmp-release-v&lt;version&gt;</p>
</div></blockquote>
</li>
<li><p class="first">Merge the PR for the <a class="reference external" href="https://github.com/astropy/astropy">astropy core repository</a> that updates the helpers, and
continue with the release process for the core as described above.</p>
</li>
</ol>
<p>This way the commit of the helpers that is tagged as the release is the same
commit that the astropy_helpers submodule will be on when the PR to astropy
testing the release gets merged.</p>
</div>
<div class="section" id="creating-a-gpg-signing-key-and-a-signed-tag">
<span id="key-signing-info"></span><h2>Creating a GPG Signing Key and a Signed Tag<a class="headerlink" href="#creating-a-gpg-signing-key-and-a-signed-tag" title="Permalink to this headline">¶</a></h2>
<p>One of the main steps in performing a release is to create a tag in the git
repository representing the exact state of the repository that represents the
version being released.  For Astropy we will always use <a class="reference external" href="http://git-scm.com/book/en/Git-Basics-Tagging#Signed-Tags">signed tags</a>: A
signed tag is annotated with the name and e-mail address of the signer, a date
and time, and a checksum of the code in the tag.  This information is then
signed with a GPG private key and stored in the repository.</p>
<p>Using a signed tag ensures the integrity of the contents of that tag for the
future.  On a distributed VCS like git, anyone can create a tag of Astropy
called &#8220;0.1&#8221; in their repository&#8211;and where it&#8217;s easy to monkey around even
after the tag has been created.  But only one &#8220;0.1&#8221; will be signed by one of
the Astropy project coordinators and will be verifiable with their public key.</p>
<div class="section" id="generating-a-public-private-key-pair">
<h3>Generating a public/private key pair<a class="headerlink" href="#generating-a-public-private-key-pair" title="Permalink to this headline">¶</a></h3>
<p>Git uses GPG to created signed tags, so in order to perform an Astropy release
you will need GPG installed and will have to generated a signing key pair.
Most *NIX installations come with GPG installed by default (as it is used to
verify the integrity of system packages).  If you don&#8217;t have the <code class="docutils literal"><span class="pre">gpg</span></code>
command, consult the documentation for your system on how to install it.</p>
<p>For OSX, GPG can be installed from MacPorts using <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">port</span> <span class="pre">install</span> <span class="pre">gnupg</span></code>.</p>
<p>To create a new public/private key pair, simply run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ gpg --gen-key
</pre></div>
</div>
<p>This will take you through a few interactive steps. For the encryption
and expiry settings, it should be safe to use the default settings (I use
a key size of 4096 just because what does a couple extra kilobytes
hurt?) Enter your full name, preferably including your middle name or
middle initial, and an e-mail address that you expect to be active for a
decent amount of time. Note that this name and e-mail address must match
the info you provide as your git configuration, so you should either
choose the same name/e-mail address when you create your key, or update
your git configuration to match the key info. Finally, choose a very good
pass phrase that won&#8217;t be easily subject to brute force attacks.</p>
<p>If you expect to use the same key for some time, it&#8217;s good to make a backup of
both your public and private key:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ gpg --export --armor &gt; public.key
$ gpg --export-secret-key --armor &gt; private.key
</pre></div>
</div>
<p>Back up these files to a trusted location&#8211;preferably a write-once physical
medium that can be stored safely somewhere.  One may also back up their keys to
a trusted online encrypted storage, though some might not find that secure
enough&#8211;it&#8217;s up to you and what you&#8217;re comfortable with.</p>
</div>
<div class="section" id="add-your-public-key-to-a-keyserver">
<h3>Add your public key to a keyserver<a class="headerlink" href="#add-your-public-key-to-a-keyserver" title="Permalink to this headline">¶</a></h3>
<p>Now that you have a public key, you can publish this anywhere you like&#8211;in your
e-mail, in a public code repository, etc.  You can also upload it to a
dedicated public OpenPGP keyserver.  This will store the public key
indefinitely (until you manually revoke it), and will be automatically synced
with other keyservers around the world.  That makes it easy to retrieve your
public key using the gpg command-line tool.</p>
<p>To do this you will need your public key&#8217;s keyname.  To find this enter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ gpg --list-keys
</pre></div>
</div>
<p>This will output something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/.</span><span class="n">gnupg</span><span class="o">/</span><span class="n">pubring</span><span class="o">.</span><span class="n">gpg</span>
<span class="o">---------------------------------------------</span>
<span class="n">pub</span>   <span class="mi">4096</span><span class="n">D</span><span class="o">/</span><span class="mi">1234</span><span class="n">ABCD</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">uid</span>                  <span class="n">Your</span> <span class="n">Name</span> <span class="o">&lt;</span><span class="n">your_email</span><span class="o">&gt;</span>
<span class="n">sub</span>   <span class="mi">4096</span><span class="n">g</span><span class="o">/</span><span class="mi">567890</span><span class="n">EF</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
</pre></div>
</div>
<p>The 8 digit hex number on the line starting with &#8220;pub&#8221;&#8211;in this example the
&#8220;1234ABCD&#8221; unique keyname for your public key.  To push it to a keyserver
enter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ gpg --send-keys 1234ABCD
</pre></div>
</div>
<p>But replace the 1234ABCD with the keyname for your public key.  Most systems
come configured with a sensible default keyserver, so you shouldn&#8217;t have to
specify any more than that.</p>
</div>
<div class="section" id="create-a-tag">
<h3>Create a tag<a class="headerlink" href="#create-a-tag" title="Permalink to this headline">¶</a></h3>
<p>Now test creating a signed tag in git.  It&#8217;s safe to experiment with this&#8211;you
can always delete the tag before pushing it to a remote repository:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git tag -s v0.1 -m &quot;Astropy version 0.1&quot;
</pre></div>
</div>
<p>This will ask for the password to unlock your private key in order to sign
the tag with it.  Confirm that the default signing key selected by git is the
correct one (it will be if you only have one key).</p>
<p>Once the tag has been created, you can verify it with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git tag -v v0.1
</pre></div>
</div>
<p>This should output something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nb">object</span> <span class="n">e8e3e3edc82b02f2088f4e974dbd2fe820c0d934</span>
<span class="nb">type</span> <span class="n">commit</span>
<span class="n">tag</span> <span class="n">v0</span><span class="o">.</span><span class="mi">1</span>
<span class="n">tagger</span> <span class="n">Your</span> <span class="n">Name</span> <span class="o">&lt;</span><span class="n">your_email</span><span class="o">&gt;</span> <span class="mi">1339779534</span> <span class="o">-</span><span class="mi">0400</span>

<span class="n">Astropy</span> <span class="n">version</span> <span class="mf">0.1</span>
<span class="n">gpg</span><span class="p">:</span> <span class="n">Signature</span> <span class="n">made</span> <span class="n">Fri</span> <span class="mi">15</span> <span class="n">Jun</span> <span class="mi">2012</span> <span class="mi">12</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">04</span> <span class="n">PM</span> <span class="n">EDT</span> <span class="n">using</span> <span class="n">DSA</span> <span class="n">key</span> <span class="n">ID</span> <span class="mi">0123</span><span class="n">ABCD</span>
<span class="n">gpg</span><span class="p">:</span> <span class="n">Good</span> <span class="n">signature</span> <span class="kn">from</span> <span class="s2">&quot;Your Name &lt;your_email&gt;&quot;</span>
</pre></div>
</div>
<p>You can use this to verify signed tags from any repository as long as you have
the signer&#8217;s public key in your keyring.  In this case you signed the tag
yourself, so you already have your public key.</p>
<p>Note that if you are planning to do a release following the steps below, you
will want to delete the tag you just created, because the release script does
that for you.  You can delete this tag by doing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ git tag -d v0.1
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Release Procedures</a><ul>
<li><a class="reference internal" href="#release-procedure">Release Procedure</a><ul>
<li><a class="reference internal" href="#modifications-for-a-beta-release-candidate-release">Modifications for a beta/release candidate release</a></li>
</ul>
</li>
<li><a class="reference internal" href="#performing-a-feature-freeze-branching-new-major-versions">Performing a Feature Freeze/Branching new Major Versions</a></li>
<li><a class="reference internal" href="#maintaining-bug-fix-releases">Maintaining Bug Fix Releases</a><ul>
<li><a class="reference internal" href="#backporting-fixes-from-master">Backporting fixes from master</a></li>
<li><a class="reference internal" href="#making-fixes-directly-to-the-bug-fix-branch">Making fixes directly to the bug fix branch</a></li>
<li><a class="reference internal" href="#preparing-the-bug-fix-branch-for-release">Preparing the bug fix branch for release</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coordinating-astropy-and-astropy-helpers-releases">Coordinating Astropy and astropy-helpers Releases</a></li>
<li><a class="reference internal" href="#creating-a-gpg-signing-key-and-a-signed-tag">Creating a GPG Signing Key and a Signed Tag</a><ul>
<li><a class="reference internal" href="#generating-a-public-private-key-pair">Generating a public/private key pair</a></li>
<li><a class="reference internal" href="#add-your-public-key-to-a-keyserver">Add your public key to a keyserver</a></li>
<li><a class="reference internal" href="#create-a-tag">Create a tag</a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="http://github.com/astropy/astropy/tree/master/docs/development/releasing.rst">Edit This Page on Github</a> &nbsp;
    <a href="../_sources/development/releasing.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.5.6. &nbsp;
    Last built 05 Jul 2017. <br/>
  </p>
</footer>
  </body>
</html>