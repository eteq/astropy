<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Slicing Multidimensional Data &#8212; Astropy v3.0.dev19489</title>
    
    <link rel="stylesheet" href="../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.0.dev19489',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Controlling Axes" href="controlling_axes.html" />
    <link rel="prev" title="Overlaying coordinate systems" href="overlaying_coordinate_systems.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="controlling_axes.html" title="Controlling Axes">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="overlaying_coordinate_systems.html" title="Overlaying coordinate systems">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../index.html">Astropy v3.0.dev19489</a>
	 &#187;
      </li>
      <li><a href="../index.html" >Data Visualization (<code class="docutils literal"><span class="pre">astropy.visualization</span></code>)</a> &#187;</li>
      <li><a href="index.html" accesskey="U">Making plots with world coordinates (WCSAxes)</a> &#187;</li>
      
      <li>Slicing Multidimensional Data</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="slicing-multidimensional-data">
<h1>Slicing Multidimensional Data<a class="headerlink" href="#slicing-multidimensional-data" title="Permalink to this headline">¶</a></h1>
<p>WCSAxes can ultimately only plot two-dimensional data. If we have an
n-dimensional dataset, we have to select which dimensions to use for
the x and y axis of the image. This example will show how to slice a FITS
data cube and plot an image from it.</p>
<div class="section" id="slicing-the-wcs-object">
<h2>Slicing the WCS object<a class="headerlink" href="#slicing-the-wcs-object" title="Permalink to this headline">¶</a></h2>
<p>Like the example introduced in <a class="reference internal" href="initializing_axes.html#initialization"><span class="std std-ref">Initializing axes with world coordinates</span></a>, we will read in the
data using <a class="reference external" href="http://docs.astropy.org/en/stable/io/fits/index.html">astropy.io.fits</a> and parse the WCS
information. The original FITS file can be downloaded from <a class="reference external" href="http://astrofrog.github.io/wcsaxes-datasets/L1448_13CO.fits">here</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.wcs</span> <span class="kn">import</span> <span class="n">WCS</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">get_pkg_data_filename</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">get_pkg_data_filename</span><span class="p">(</span><span class="s1">&#39;l1448/l1448_13co.fits&#39;</span><span class="p">)</span>
<span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">hdu</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="n">image_data</span> <span class="o">=</span> <span class="n">hdu</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>This is a three-dimensional dataset which you can check by looking at the
header information by:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span><span class="o">.</span><span class="n">header</span>  
<span class="gp">...</span>
<span class="go">NAXIS = 3 /number of axes</span>
<span class="go">CTYPE1  = &#39;RA---SFL&#39;           /</span>
<span class="go">CTYPE2  = &#39;DEC--SFL&#39;           /</span>
<span class="go">CTYPE3  = &#39;VELO-LSR&#39;           /</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>The header keyword &#8216;NAXIS&#8217; gives the number of dimensions of the dataset. The keywords &#8216;CTYPE1&#8217;, &#8216;CTYPE2&#8217; and &#8216;CTYPE3&#8217; give the data type of these dimensions to be right ascension, declination and velocity respectively.</p>
<p>We then instantiate the <a class="reference internal" href="../../api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes" title="astropy.visualization.wcsaxes.WCSAxes"><code class="xref py py-obj docutils literal"><span class="pre">WCSAxes</span></code></a> using the
<a class="reference internal" href="../../api/astropy.wcs.WCS.html#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-class docutils literal"><span class="pre">WCS</span></code></a> object and select the slices we want to plot:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">wcs</span><span class="p">,</span> <span class="n">slices</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>By setting <code class="docutils literal"><span class="pre">slices=(50,</span> <span class="pre">'y',</span> <span class="pre">'x')</span></code>, we have chosen to plot the second
dimension on the y-axis and the third dimension on the x-axis. Even though we
are not plotting the all the dimensions, we have to specify which slices to
select for the dimensions that are not shown. In this example, we are not
plotting the first dimension so we have selected the slice 50 to display. You
can experiment with this by changing the selected slice and looking at how the
plotted image changes.</p>
</div>
<div class="section" id="plotting-the-image">
<h2>Plotting the image<a class="headerlink" href="#plotting-the-image" title="Permalink to this headline">¶</a></h2>
<p>We then add the axes to the image and plot it using the method
<a class="reference external" href="http://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.imshow.html#matplotlib.axes.Axes.imshow" title="(in Matplotlib v2.0.2)"><code class="xref py py-meth docutils literal"><span class="pre">imshow()</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">exclude_overlapping</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-3.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-3.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-3.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/slicing_datacubes-3.png" src="../../_images/slicing_datacubes-3.png" />
</div>
<p>Here, <code class="docutils literal"><span class="pre">image_data</span></code> is an <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">ndarray</span></code></a> object. In Numpy, the order
of the axes is reversed so the first dimension in the FITS file appears last,
the last dimension appears first and so on. Therefore the index passed to
<a class="reference external" href="http://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.imshow.html#matplotlib.axes.Axes.imshow" title="(in Matplotlib v2.0.2)"><code class="xref py py-meth docutils literal"><span class="pre">imshow()</span></code></a> should be the same as passed to
<code class="docutils literal"><span class="pre">slices</span></code> but in reversed order. We also need to
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.transpose.html#numpy.ndarray.transpose" title="(in NumPy v1.13)"><code class="xref py py-meth docutils literal"><span class="pre">transpose()</span></code></a> <code class="docutils literal"><span class="pre">image_data</span></code> as we have reversed the
dimensions plotted on the x and y axes in the slice.</p>
<p>If we don&#8217;t want to reverse the dimensions plotted, we can simply do:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">wcs</span><span class="p">,</span> <span class="n">slices</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">50</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-5.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-5.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-5.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/slicing_datacubes-5.png" src="../../_images/slicing_datacubes-5.png" />
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Slicing Multidimensional Data</a><ul>
<li><a class="reference internal" href="#slicing-the-wcs-object">Slicing the WCS object</a></li>
<li><a class="reference internal" href="#plotting-the-image">Plotting the image</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="http://github.com/astropy/astropy/tree/master/docs/visualization/wcsaxes/slicing_datacubes.rst">Edit This Page on Github</a> &nbsp;
    <a href="../../_sources/visualization/wcsaxes/slicing_datacubes.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.5.6. &nbsp;
    Last built 05 Jul 2017. <br/>
  </p>
</footer>
  </body>
</html>