<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>biweight_midcovariance &#8212; Astropy v3.0.dev19489</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0.dev19489',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="biweight_midvariance" href="astropy.stats.biweight_midvariance.html" />
    <link rel="prev" title="biweight_midcorrelation" href="astropy.stats.biweight_midcorrelation.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="astropy.stats.biweight_midvariance.html" title="biweight_midvariance">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="astropy.stats.biweight_midcorrelation.html" title="biweight_midcorrelation">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v3.0.dev19489</a>
	 &#187;
      </li>
      <li><a href="../stats/index.html" accesskey="U">Astrostatistics Tools (<code class="docutils literal"><span class="pre">astropy.stats</span></code>)</a> &#187;</li>
      
      <li>biweight_midcovariance</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="biweight-midcovariance">
<h1>biweight_midcovariance<a class="headerlink" href="#biweight-midcovariance" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="astropy.stats.biweight_midcovariance">
<code class="descclassname">astropy.stats.</code><code class="descname">biweight_midcovariance</code><span class="sig-paren">(</span><em>data</em>, <em>c=9.0</em>, <em>M=None</em>, <em>modify_sample_size=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/stats/biweight.html#biweight_midcovariance"><span class="viewcode-link">[source]</span></a><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/stats/biweight.py#L367" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="headerlink" href="#astropy.stats.biweight_midcovariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the biweight midcovariance between pairs of multiple
variables.</p>
<p>The biweight midcovariance is a robust and resistant estimator of
the covariance between two variables.</p>
<p>This function computes the biweight midcovariance between all pairs
of the input variables (rows) in the input data.  The output array
will have a shape of (N_variables, N_variables).  The diagonal
elements will be the biweight midvariances of each input variable
(see <a class="reference internal" href="astropy.stats.biweight_midvariance.html#astropy.stats.biweight_midvariance" title="astropy.stats.biweight_midvariance"><code class="xref py py-func docutils literal"><span class="pre">biweight_midvariance()</span></code></a>).  The off-diagonal elements will
be the biweight midcovariances between each pair of input variables.</p>
<p>For example, if the input array <code class="docutils literal"><span class="pre">data</span></code> contains three variables
(rows) <code class="docutils literal"><span class="pre">x</span></code>, <code class="docutils literal"><span class="pre">y</span></code>, and <code class="docutils literal"><span class="pre">z</span></code>, the output <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-obj docutils literal"><span class="pre">ndarray</span></code></a>
midcovariance matrix will be:</p>
<div class="math">
<p><img src="../_images/math/29579eed78980d8a9867f3a8defa48e77de73eb3.png" alt="\begin{pmatrix}
\zeta_{xx}  &amp; \zeta_{xy}  &amp; \zeta_{xz} \\
\zeta_{yx}  &amp; \zeta_{yy}  &amp; \zeta_{yz} \\
\zeta_{zx}  &amp; \zeta_{zy}  &amp; \zeta_{zz}
\end{pmatrix}"/></p>
</div><p>where <img class="math" src="../_images/math/2d9783b3321cda9d7d0d2068d858bd6fea5057a4.png" alt="\zeta_{xx}"/>, <img class="math" src="../_images/math/0c1c5bfc0141fd98ee5dde9f74b591ae497d07fe.png" alt="\zeta_{yy}"/>, and <img class="math" src="../_images/math/968df015aad60a41a531ef2431f1a6d3a7bfe91a.png" alt="\zeta_{zz}"/>
are the biweight midvariances of each variable.  The biweight
midcovariance between <img class="math" src="../_images/math/a59f68a4202623bb859a7093f0316bf466e6f75d.png" alt="x"/> and <img class="math" src="../_images/math/276f7e256cbddeb81eee42e1efc348f3cb4ab5f8.png" alt="y"/> is <img class="math" src="../_images/math/2b69d8cee4ed1ae8c24f26ad97a0eec8e576c212.png" alt="\zeta_{xy}"/>
(<img class="math" src="../_images/math/64d117985b04312e892cbbaaeb46f6f2a1afc03c.png" alt="= \zeta_{yx}"/>).  The biweight midcovariance between
<img class="math" src="../_images/math/a59f68a4202623bb859a7093f0316bf466e6f75d.png" alt="x"/> and <img class="math" src="../_images/math/683f2dd9129a91d21aaf1c04afa6f78b39d4cb0a.png" alt="z"/> is <img class="math" src="../_images/math/0c341d0a2279e0054308c2592f84623098e6de7e.png" alt="\zeta_{xz}"/> (<img class="math" src="../_images/math/99beb9b5785989d863029c3a5f0dd63d8cf01dc7.png" alt="=
\zeta_{zx}"/>).  The biweight midcovariance between <img class="math" src="../_images/math/276f7e256cbddeb81eee42e1efc348f3cb4ab5f8.png" alt="y"/> and
<img class="math" src="../_images/math/683f2dd9129a91d21aaf1c04afa6f78b39d4cb0a.png" alt="z"/> is <img class="math" src="../_images/math/68a5f9826dfa7b6cd0aff50d49dedf565f27f917.png" alt="\zeta_{yz}"/> (<img class="math" src="../_images/math/25cc9e8c6762ecca8c86c5e44aeef19f306b2f2f.png" alt="= \zeta_{zy}"/>).</p>
<p>The biweight midcovariance between two variables <img class="math" src="../_images/math/a59f68a4202623bb859a7093f0316bf466e6f75d.png" alt="x"/> and
<img class="math" src="../_images/math/276f7e256cbddeb81eee42e1efc348f3cb4ab5f8.png" alt="y"/> is given by:</p>
<div class="math">
<p><img src="../_images/math/f8b5a8307c4cd700b7ccfa0a5036190b81554f46.png" alt="\zeta_{xy} = n \ \frac{\Sigma_{|u_i| &lt; 1, \ |v_i| &lt; 1} \
    (x_i - M_x) (1 - u_i^2)^2 (y_i - M_y) (1 - v_i^2)^2}
    {(\Sigma_{|u_i| &lt; 1} \ (1 - u_i^2) (1 - 5u_i^2))
    (\Sigma_{|v_i| &lt; 1} \ (1 - v_i^2) (1 - 5v_i^2))}"/></p>
</div><p>where <img class="math" src="../_images/math/2c29d150b931d2f49684a53fd5e2b304319e794f.png" alt="M_x"/> and <img class="math" src="../_images/math/4d3914d6ca278c19430295461d2e88e684817a5a.png" alt="M_y"/> are the medians (or the input
locations) of the two variables and <img class="math" src="../_images/math/21d924acd9c2a69519517fb0584c1d74dade3023.png" alt="u_i"/> and <img class="math" src="../_images/math/fb3c41a9a30bddef43f2e990beafe42151ccc93b.png" alt="v_i"/> are
given by:</p>
<div class="math">
<p><img src="../_images/math/b641674e3571da6aaee67562da84595c2c08308f.png" alt="u_{i} = \frac{(x_i - M_x)}{c * MAD_x}

v_{i} = \frac{(y_i - M_y)}{c * MAD_y}"/></p>
</div><p>where <img class="math" src="../_images/math/ae12a24f88803b5895632e4848d87d46483c492c.png" alt="c"/> is the biweight tuning constant and <img class="math" src="../_images/math/19b65e2b08374eaa474e004f67de4d528100ad17.png" alt="MAD_x"/>
and <img class="math" src="../_images/math/12517278cbf6591c3d12e11adc9839c2b36aefd7.png" alt="MAD_y"/> are the <a class="reference external" href="https://en.wikipedia.org/wiki/Median_absolute_deviation">median absolute deviation</a> of the
<img class="math" src="../_images/math/a59f68a4202623bb859a7093f0316bf466e6f75d.png" alt="x"/> and <img class="math" src="../_images/math/276f7e256cbddeb81eee42e1efc348f3cb4ab5f8.png" alt="y"/> variables.  The biweight midvariance tuning
constant <code class="docutils literal"><span class="pre">c</span></code> is typically 9.0 (the default).</p>
<p>For the standard definition of biweight midcovariance <img class="math" src="../_images/math/e11f2701c4a39c7fe543a6c4150b421d50f1c159.png" alt="n"/> is
the total number of observations of each variable.  That definition
is used if <code class="docutils literal"><span class="pre">modify_sample_size</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.6)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>, which is the default.</p>
<p>However, if <code class="docutils literal"><span class="pre">modify_sample_size</span> <span class="pre">=</span> <span class="pre">True</span></code>, then <img class="math" src="../_images/math/e11f2701c4a39c7fe543a6c4150b421d50f1c159.png" alt="n"/> is the
number of observations for which <img class="math" src="../_images/math/d72c0ef95909d16f4c66c4e8b259527d55887470.png" alt="|u_i| &lt; 1"/> and <img class="math" src="../_images/math/ef6faf5e8603e316d21a5341598d1f7a126d41fe.png" alt="|v_i|
&lt; 1"/>, i.e.</p>
<div class="math">
<p><img src="../_images/math/1991993c2f665f91365bbc3619ad14102bd26a63.png" alt="n = \Sigma_{|u_i| &lt; 1, \ |v_i| &lt; 1} \ 1"/></p>
</div><p>which results in a value closer to the true variance for small
sample sizes or for a large number of rejected values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : 2D or 1D array-like</p>
<blockquote>
<div><p>Input data either as a 2D or 1D array.  For a 2D array, it
should have a shape (N_variables, N_observations).  A 1D array
may be input for observations of a single variable, in which
case the biweight midvariance will be calculated (no
covariance).  Each row of <code class="docutils literal"><span class="pre">data</span></code> represents a variable, and
each column a single observation of all those variables (same as
the <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.cov.html#numpy.cov" title="(in NumPy v1.13)"><code class="xref py py-obj docutils literal"><span class="pre">numpy.cov</span></code></a> convention).</p>
</div></blockquote>
<p><strong>c</strong> : float, optional</p>
<blockquote>
<div><p>Tuning constant for the biweight estimator (default = 9.0).</p>
</div></blockquote>
<p><strong>M</strong> : float or 1D array-like, optional</p>
<blockquote>
<div><p>The location estimate of each variable, either as a scalar or
array.  If <code class="docutils literal"><span class="pre">M</span></code> is an array, then its must be a 1D array
containing the location estimate of each row (i.e. <code class="docutils literal"><span class="pre">a.ndim</span></code>
elements).  If <code class="docutils literal"><span class="pre">M</span></code> is a scalar value, then its value will be
used for each variable (row).  If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.6)"><code class="xref py py-obj docutils literal"><span class="pre">None</span></code></a> (default), then the
median of each variable (row) will be used.</p>
</div></blockquote>
<p><strong>modify_sample_size</strong> : bool, optional</p>
<blockquote>
<div><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.6)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a> (default), then the sample size used is the total
number of observations of each variable, which follows the
standard definition of biweight midcovariance.  If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.6)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>, then
the sample size is reduced to correct for any rejected values
(see formula above), which results in a value closer to the true
covariance for small sample sizes or for a large number of
rejected values.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>biweight_midcovariance</strong> : <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-obj docutils literal"><span class="pre">ndarray</span></code></a></p>
<blockquote class="last">
<div><p>A 2D array representing the biweight midcovariances between each
pair of the variables (rows) in the input array.  The output
array will have a shape of (N_variables, N_variables).  The
diagonal elements will be the biweight midvariances of each
input variable.  The off-diagonal elements will be the biweight
midcovariances between each pair of input variables.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="astropy.stats.biweight_midvariance.html#astropy.stats.biweight_midvariance" title="astropy.stats.biweight_midvariance"><code class="xref py py-obj docutils literal"><span class="pre">biweight_midvariance</span></code></a>, <a class="reference internal" href="astropy.stats.biweight_midcorrelation.html#astropy.stats.biweight_midcorrelation" title="astropy.stats.biweight_midcorrelation"><code class="xref py py-obj docutils literal"><span class="pre">biweight_midcorrelation</span></code></a>, <a class="reference internal" href="astropy.stats.biweight_scale.html#astropy.stats.biweight_scale" title="astropy.stats.biweight_scale"><code class="xref py py-obj docutils literal"><span class="pre">biweight_scale</span></code></a>, <a class="reference internal" href="astropy.stats.biweight_location.html#astropy.stats.biweight_location" title="astropy.stats.biweight_location"><code class="xref py py-obj docutils literal"><span class="pre">biweight_location</span></code></a></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r59" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[R59]</a></td><td><a class="reference external" href="http://www.itl.nist.gov/div898/software/dataplot/refman2/auxillar/biwmidc.htm">http://www.itl.nist.gov/div898/software/dataplot/refman2/auxillar/biwmidc.htm</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Compute the biweight midcovariance between two random variables:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.stats</span> <span class="k">import</span> <span class="n">biweight_midcovariance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate two random variables x and y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Introduce an obvious outlier</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">30.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate the biweight midcovariances between x and y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bicov</span> <span class="o">=</span> <span class="n">biweight_midcovariance</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bicov</span><span class="p">)</span>    
<span class="go">[[ 0.82483155 -0.18961219]</span>
<span class="go"> [-0.18961219 9.80265764]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print standard deviation estimates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">bicov</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()))</span>    
<span class="go">[ 0.90820237  3.13091961]</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">biweight_midcovariance</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/astropy.stats.biweight_midcovariance.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.5.6. &nbsp;
    Last built 05 Jul 2017. <br/>
  </p>
</footer>
  </body>
</html>